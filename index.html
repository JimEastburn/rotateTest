<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">

<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>Rotate Test Page</title>
	<meta name="author" content="Jim Eastburn">
	
	<script >
		var howOften = 50;
		var current = 1;
		var speedRightRotation = 0;
		var speedLeftRotation = 0;
		var rightRotationSpeedConst = "Right rotation speed = ";
		var leftRotationSpeedConst = "Left rotation speed = ";
		var mouseStartXConst = "mouse start X: ";
		var mouseStartYConst = "mouse start Y: ";
		var mouseEndXConst = "mouse end X: ";
		var mouseEndYConst = "mouse end Y: ";
		
		var items = new Array();
		var rotateRightQueue = new Array();
		var rotateLeftQueue = new Array();

		var mouseStartX = 0;
		var mouseStartY = 0;

		var drill = '';



		for (var i = 1; i < 10; i++){
			items[i]="<img src='http://www.thinkgeekspeak.com/images/drill_400-01-0" + i + ".jpg' height='300' width='300'/>"; 
		}
		for (var j = 10; j < 37; j++){
			items[j]="<img src='http://www.thinkgeekspeak.com/images/drill_400-01-" + j + ".jpg' height='300' width='300'/>"; 
		}

		

		function increaseLeftRotationSpeedByOne (){

			this.rotateLeft();
			speedLeftRotation++;
			this.showLeftRotationSpeed();
		}

		function increaseRightRotationSpeedByOne (){

			this.rotateRight();
			speedRightRotation++;
			this.showRightRotationSpeed();
		}

		function decreaseRightRotationSpeedByOne (){
			for(var i = 0; i < rotateRightQueue.length; i++){
				clearTimeout(rotateRightQueue[i]);
			}
			rotateRightQueue = new Array();
			
			for (var i = 0; i < speedRightRotation-1; i++){
				this.rotateRight();
			}

			if (speedRightRotation > 0){
				speedRightRotation--;
			}
			this.showRightRotationSpeed();
			
		}

		function decreaseLeftRotationSpeedByOne (){
			
			for(var i = 0; i < rotateLeftQueue.length; i++){
				clearTimeout(rotateLeftQueue[i]);
			}
			rotateLeftQueue = new Array();
			
			for (var i = 0; i < speedLeftRotation-1; i++){
				this.rotateLeft();
			}

			if (speedLeftRotation > 0){
				speedLeftRotation--;
			}
			this.showLeftRotationSpeed();
		}

		function stopAutoRotationLeft (){

			for(var i = 0; i < rotateLeftQueue.length; i++){
				clearTimeout(rotateLeftQueue[i]);
			}
			rotateLeftQueue = new Array();
			speedLeftRotation = 0;
			this.showLeftRotationSpeed();
			
		}

		function stopAutoRotationRight (){

			for(var j = 0; j < rotateRightQueue.length; j++){
				clearTimeout(rotateRightQueue[j]);
			}
			rotateRightQueue = new Array();
			speedRightRotation = 0;
			this.showRightRotationSpeed();
			
		}

		function stopAutoRotationLeftAndRight (){
			this.stopAutoRotationLeft();
			this.stopAutoRotationRight();
		}

		function rotateLeft() {
		    document.getElementById("drill").innerHTML = items[current];
		    

		    if(current===items.length-1){
		    	current = 1;
		    }
		    else{
		    	current++;
		    }
		     rotateLeftQueue.push(setTimeout("rotateLeft()",howOften));
		}
		   

		function rotateRight() {
		    document.getElementById("drill").innerHTML = items[current];
		    this.showRightRotationSpeed();

		    if(current===1){
		    	current = 36;
		    }
		    else{
		    	current--;
		    }
		    rotateRightQueue.push(setTimeout("rotateRight()",howOften));
		}

		function showRightRotationSpeed(){
			document.getElementById("rightRotationSpeed").innerHTML = rightRotationSpeedConst + speedRightRotation;
		}

		function showLeftRotationSpeed(){
			document.getElementById("leftRotationSpeed").innerHTML = leftRotationSpeedConst + speedLeftRotation;
		}

		function showMouseStartX(){
			document.getElementById("mouseStartX").innerHTML = mouseStartXConst + mouseStartX;
		}

		function showMouseStartY(){
			document.getElementById("mouseStartY").innerHTML = mouseStartYConst + mouseStartY;
		}

		function showMouseEndX(){
			document.getElementById("mouseEndX").innerHTML = mouseEndXConst + mouseEndX;
		}

		function showMouseEndY(){
			document.getElementById("mouseEndY").innerHTML = mouseEndYConst + mouseEndY;
		}

		// function makeVelocityCalculator(e_init, callback) {
		//     var x = e_init.clientX,
		//         y = e_init.clientY,
		//         t = Date.now();
		// 	    return function(e) {
		// 	        var new_x = e.clientX,
		// 	            new_y = e.clientY,
		// 	            new_t = Date.now();
		// 	        var x_dist = new_x - x,
		// 	            y_dist = new_y - y,
		// 	            interval = new_t - t;
		// 	        // update values:
		// 	        x = new_x;
		// 	        y = new_y;
		// 	        t = new_t;
		// 	        var velocity = Math.sqrt(x_dist*x_dist+y_dist*y_dist)/interval;
		// 	        callback(velocity);
		// 	    };
		// }

		function getElementDrill(){
			drill = document.getElementById("drill");
			drill.ondragstart = function() { return false; };
			var self = this;
			drill.onmousedown = function(e){
				mouseStartX = e.x;
				mouseStartY = e.y;
				self.showMouseStartX();
				self.showMouseStartY();

				// var log = makeVelocityCalculator(e, function(v) {
		  //           drill.text(v+" pixel/ms");
		  //       });

				    document.onmousemove = function(e){
				    	//log();
				        mouseEndX = e.x;
						mouseEndY = e.y;
						self.showMouseEndX();
						self.showMouseEndY();
				    }
				    document.onmouseup = function(e){
				        mouseEndX = e.x;
						mouseEndY = e.y;
						self.showMouseEndX();
						self.showMouseEndY();
				        document.onmousemove = function(){
				        	//log();
				        };
				    }
			}
		}

		

		
	
		window.onload = getElementDrill;
		//window.onmousedown=mousedown;
		//window.onmouseup=mouseup;			
</script>
		
</head>
<body>
	<div id="drill"><img src='http://www.thinkgeekspeak.com/images/drill_400-01-01.jpg' height='300' width='300'/> </div>
	<button onclick="increaseLeftRotationSpeedByOne()">Rotation Left Speed +1</button>
	<button onclick="increaseRightRotationSpeedByOne()">Rotation Right Speed +1</button>
	<button onclick="stopAutoRotationLeftAndRight()">Stop Rotation</button>
	
	<div> 
		<button onclick="decreaseLeftRotationSpeedByOne()">Rotation Left Speed -1</button>
		<button onclick="decreaseRightRotationSpeedByOne()">Rotation Right Speed -1</button>
	</div>
	
	<div id="rightRotationSpeed">Right rotation speed = 0</div>
	<div id="leftRotationSpeed">Left rotation speed = 0</div>

	<div id="mouseStartX">mouseStartX = 0</div>
	<div id="mouseStartY">mouseStartY = 0</div>

	<div id="mouseEndX">mouseEndX = 0</div>
	<div id="mouseEndY">mouseEndY = 0</div>
	<!-- show current speed -->

	
</body>
</html>